var MovieApp;!function(e){var o=function(){function e(e,o,t){var i=this;this.$scope=e,this.$location=o,this.MovieService=t,this.$scope.$on("$locationChangeSuccess",function(){i.setActiveUrlPart()}),t.GetMoviesToDownload().then(function(e){i.$scope.moviesToDownload=e})}return e.prototype.setActiveUrlPart=function(){var e=this.$location.path().split("/");this.$scope.active=e[1]},Object.defineProperty(e.prototype,"moviesToDownload",{get:function(){return this.$scope.moviesToDownload},enumerable:!0,configurable:!0}),e.prototype.markMovieAsDownloaded=function(e){e.Downloaded=!0},e.prototype.deleteMovieFromDownloadList=function(e){var o=this;this.MovieService.DeleteMovieFromDownloadList(e).then(function(){o.$scope.moviesToDownload=_.without(o.$scope.moviesToDownload,e)})},e.$inject=["$scope","$location","MovieService"],e}();e.HomeController=o}(MovieApp||(MovieApp={})),app.controller("HomeController",MovieApp.HomeController);var app=angular.module("movieApp",["ngRoute"]);app.config(["$routeProvider",function(e){e.when("/Cinema",{templateUrl:"/Home/Cinema",controller:"MovieController",resolve:{movies:["MovieService",function(e){return e.GetMoviesInCinema()}]}}).when("/Rent",{templateUrl:"/Home/Rent",controller:"MovieController",controllerAs:"movieCtrl",resolve:{movies:["MovieService",function(e){return e.GetMoviesForRent()}]}}).when("/Tv",{templateUrl:"/Home/TV",controller:"MovieController"}).otherwise({redirectTo:"/Rent"})}]);var MovieApp;!function(e){var o=function(){function e(){}return Object.defineProperty(e.prototype,"MovieMeterId",{get:function(){return this._movieMeterId},set:function(e){this._movieMeterId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Url",{get:function(){return this._url},set:function(e){this._url=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Title",{get:function(){return this._title},set:function(e){this._title=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Year",{get:function(){return this._year},set:function(e){this._year=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Thumbnail",{get:function(){return this._thumbnail},set:function(e){this._thumbnail=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ImdbId",{get:function(){return this._imdbId},set:function(e){this._imdbId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Plot",{get:function(){return this._plot},set:function(e){this._plot=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this._duration},set:function(e){this._duration=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Downloaded",{get:function(){return this._downloaded},set:function(e){this._downloaded=e},enumerable:!0,configurable:!0}),e}();e.Movie=o}(MovieApp||(MovieApp={}));var MovieApp;!function(e){var o=function(){function e(e,o,t){this.$scope=e,this.movies=o,this.MovieService=t,this.$scope.movies=[];for(var i in this.movies){var n=this.movies[i],r={date:i,movies:n};this.$scope.movies.push(r)}}return e.prototype.addMovieToDownloadList=function(e){this.MovieService.AddMovieToDownloadList(e),this.$scope.moviesToDownload.push(e)},e.$inject=["$scope","movies","MovieService"],e}();e.MovieController=o,app.controller("MovieController",e.MovieController)}(MovieApp||(MovieApp={}));var MovieApp;!function(e){function o(){return{restrict:"E",replace:!0,scope:{imdb:"@"},link:function(e,o){var t=(e.imdb,new Image);$.get("https://api.themoviedb.org/3/movie/tt"+e.imdb+"?api_key=980071c1008d3dd64ab4a0893fe5a727",function(e){t.src="http://image.tmdb.org/t/p/w154"+e.poster_path,o.parent().append(t),o.remove()})}}}e.MoviePoster=o}(MovieApp||(MovieApp={})),app.directive("moviePoster",MovieApp.MoviePoster);var MovieApp;!function(e){var o=function(){function e(e,o,t){this.$http=e,this.$q=o,this.$window=t,this.DeleteMovieFromDownloadList=function(e){return this.$http.delete("/api/MoviesApi/DeleteMovieFromDownloadList?imdbId="+e.ImdbId).then(function(e){return e})},this.GetMoviesForRent=function(){var e=this.$q.defer(),o=this.$window.sessionStorage.getItem("movies");if(o){var t=angular.fromJson(o);e.resolve(t)}else this.HandleGetRequest("GetMoviesOutOnDvd").then(function(o){var t=angular.toJson(o);sessionStorage.setItem("movies",t),e.resolve(o)});return e.promise},this.GetMoviesInCinema=function(){var e=this.$q.defer(),o=sessionStorage.getItem("cinemaMovies");if(o){var t=angular.fromJson(o);e.resolve(t)}else this.HandleGetRequest("GetMoviesInCinema").then(function(o){var t=angular.toJson(o);sessionStorage.setItem("cinemaMovies",t),e.resolve(o)});return e.promise},this.GetMoviePoster=function(e){return this.$http.get("https://api.themoviedb.org/3/movie/tt"+e+"?api_key=980071c1008d3dd64ab4a0893fe5a727").then(function(e){return e.data})},this.GetMoviesToDownload=function(){return this.HandleGetRequest("GetMoviesToDownload")}}return e.prototype.AddMovieToDownloadList=function(e){return this.HandlePostRequest("AddMovieToDownloadList",e)},e.prototype.ClearSessionStorage=function(){sessionStorage.clear()},e.prototype.HandleGetRequest=function(e,o){return this.$http.get("/api/MoviesApi/"+e,o).then(function(e){return e.data})},e.prototype.HandlePostRequest=function(e,o){return this.$http.post("/api/MoviesApi/"+e,o).then(function(e){return e.data})},e.$inject=["$http","$q","$window"],e}();e.MovieService=o}(MovieApp||(MovieApp={})),app.service("MovieService",MovieApp.MovieService);var MovieApp;!function(e){function o(e){return{restrict:"A",compile:function(o){return o.attr("ng-mouseover","showHover($event, y)"),o.attr("ng-mouseleave","hideHover()"),o.removeAttr("movie-tooltip"),{post:function(o,t){function i(t,i){angular.element("#movieTooltip").remove();var n=400+i;n>=window.innerWidth&&(i-=400);var r='<div class="movie-tooltip" id="movieTooltip" style="top:'+t+"px; left:"+i+'px;"><div style="font-size:0.8em;float:right;">Duur: {{movie.Duration}}min.</div><b>{{movie.Title}}</b><br/>{{movie.Plot}}</div>',s=e(r)(o);angular.element("body").append($(s))}e(t)(o),o.showHover=function(e,t){o.movie=t,i(e.pageY,e.pageX)},o.hideHover=function(){angular.element("#movieTooltip").remove()}}}}}}e.MovieTooltip=o,o.$inject=["$compile"]}(MovieApp||(MovieApp={})),app.directive("movieTooltip",MovieApp.MovieTooltip);